<!DOCTYPE html>
<html>
<head>
  <title>Таблица Умножения</title>
</head>
<body>

<h2>Multiplication Table</h2>

<style>
  .incorrect {
    color: red;
  }
   .incorrect {
    color: green;
  }

  button {
    margin: 10px;
  }
</style>

<script>
  function generateMultiplicationTable() {
    var num1 = Math.floor(Math.random() * 10) + 1;
    var num2 = Math.floor(Math.random() * 10) + 1;
    var correctAnswer = num1 * num2;

    var question = num1 + " x " + num2 + " = " + correctAnswer;
    
    var answers = [correctAnswer, Math.floor(Math.random() * 100), Math.floor(Math.random() * 100)];
    answers.sort(() => Math.random() - 0.5);

    var questionObject = {
      question: question,
      answers: answers
    };

    localStorage.setItem("question_" + localStorage.length, JSON.stringify(questionObject));
    
    document.write("<p>Сколько " + num1 + " x " + num2 + "?</p>");

    for (var i = 0; i < answers.length; i++) {
      document.write("<button onclick='checkAnswer(" + answers[i] + "," + correctAnswer + "," + i + ")'>" + answers[i] + "</button>");
    }
  }

  function checkAnswer(selectedAnswer, correctAnswer, index) {
    const answerBtn = document.getElementsByTagName("button")[index];
    console.log(answerBtn);
    
    if (selectedAnswer === correctAnswer) {
      answerBtn.classList.add("correct");
    } else {
      answerBtn.classList.add("incorrect");
    }
    const historyObj = JSON.parse(localStorage.getItem("question_" + (localStorage.length-1)));
    
    localStorage.removeItem=("question_" + (localStorage.length-1));
    
    historyObj.answer = answerBtn.textContent;
    
    console.log(historyObj)
    
    localStorage.setItem("question_" + localStorage.length, JSON.stringify(historyObj));
    
    //location.reload();
  }

  function showPreviousQuestions() {
    for (var i = 0; i < localStorage.length; i++) {
      var questionObject = JSON.parse(localStorage.getItem("question_" + i));
      document.write("<p>" + questionObject.question + "</p>");
      document.write("<p>Answers: ");
      for (var j = 0; j < questionObject.answers.length; j++) {
        if (questionObject.answers[j] === JSON.parse(localStorage.getItem("question_" + i)).answers[0]) {
          document.write("<span>" + questionObject.answers[j] + "</span>");
        } else {
          document.write("<span class='incorrect'>" + questionObject.answers[j] + "</span>");
        }
        if (j !== questionObject.answers.length - 1) {
          document.write(", ");
        }
      }
      document.write("</p><br>");
    }
  }

  generateMultiplicationTable();
</script>

<button onclick="showPreviousQuestions()" style={margin-top:100px}>Ответы</button>

</body>
</html>
